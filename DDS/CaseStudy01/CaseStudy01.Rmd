---
title: "Craft Beer & Brewery Data Analysis"
author: "Jenna Ford & Reannan McDaniel"
date: "6/29/2019"
output: 
  html_document:
    keep_md: yes
---

## Introduction

Using the Beer and Breweries data files provided by Budweiser, our team was able to extrapolate information that could be beneficial in entering the craft beer market for Budweiser.  The elements we focused on were breweries by State, beer styles, Alcohol by Volume (ABV), and International Bitterness Unit (IBU).

The data provided for this analysis consists of 2410 US craft beers from 558 US breweries. The data analysis that follows highlights the following in order to describe the current craft beer market:

* A look at the data
* Missing values for ABV & IBU measurements
* How many breweries are in each state
* Descriptive information for ABV
* Median ABV & IBU by state
* Beer with the highest ABV and beer with the highest IBU
* Correlation between ABV and IBU

## Setup: Libraries and Reading in Datasets
```{r message=FALSE}
library(RCurl)
library(plyr)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(car)
library(naniar)
library(viridis)
library(scales)

setwd("./Data")

Beers <- read.csv(file="Beers.csv")
Breweries <- read.csv(file="Breweries.csv")

opts <- options()
options(ggplot2.continuous.colour="viridis")
options(ggplot2.continuous.fill="viridis")
```

## A Look at the Data

To get a sense of the data we have proivded below the first 6 and last 6 records of the data. Reviewing the data shows that one brewery can have multiple beers that it produces and that not all values are populated for every observation. Some information about these records is provided below:

The first six observations (sorted by by brewery ID):

* Northgate in MN is the only brewery
* The beer size for all is 16oz
* The ABV range is .045-.060
* The IBU range is 19-50
* 6 different beer styles

The last six observations (sorted by by brewery ID):

* 3 different breweries comprise the last 6 observations
* The beer size is 12oz
* The ABV range is .043-.068
* The IBU is not provided
* 6 different beer styles
* Butternuts Beer & Ale in KY is 4 of the 6 breweries

```{r question2}
BreweriesFullDataset <- merge(Breweries,Beers, by.x = "Brew_ID", by.y = "Brewery_id",all=TRUE)
names(BreweriesFullDataset) <- c("Brew_ID","Brewery","City","State","Beer","Beer_ID","ABV","IBU","Style","Ounces")
head(BreweriesFullDataset,6)
tail(BreweriesFullDataset,6)
```

## Missing Values

An analysis of missing values present in the data can help identify patterns. ABV and IBU were the only fields where missing values were found. It is interesting to note that there is a high percentage of missing values for IBU (42%) but not ABV (3%). Also, every instance where ABV was missing, IBU was also missing. 

```{r question3a}
gg_miss_var(BreweriesFullDataset) +
  ggtitle("Missing Values by Variable") + 
  theme(plot.title = element_text(hjust = 0.5))
```

The next chart highlights the percentage of missing values for ABV and IBU by state. SD does not have any records where IBU is populated.

```{r question3b}
gg_miss_fct(x=select(BreweriesFullDataset,State,ABV,IBU),fct=State) +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust=0.5)) +
  ggtitle("% Missing ABV & IBU Values by State")
```

## Brewery Counts by State

The following charts shows brewery counts by state. Colorado, California, Michigan, Oregan and Texas are 5 states with the most craft breweries. Nevada, D.C., North Dakota, South Dakota and West Virginia are the 5 locales with the fewest craft breweries.

The more saturated a market is the more difficult it may be to enter the market. More research on overall beer consumption compared to craft beer consumption by market is recommended to help identify an ideal place to enter the market.

```{r question1}
BreweriesByState <- plyr::count(Breweries$State)

ggplot(BreweriesByState,aes(x=reorder(x,-freq),y=freq,fill=freq)) +
  geom_bar(stat="identity",position="dodge",show.legend=FALSE) +
  xlab("State") +
  ylab("Brewery Count") +
  ggtitle("Brewery Counts by State") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust=0.5))
```

## Summary Statistics for ABV
```{r question6}
summary(BreweriesFullDataset$ABV)
ggplot(BreweriesFullDataset,aes(y=ABV)) +
  geom_boxplot(fill="#93e45c") +
  scale_x_discrete(limits=c("0")) +
  ggtitle("ABV Summary Statistics") +
  theme(plot.title = element_text(hjust = 0.5))
```

## Median ABV & IBU by State
```{r question4}
Median.ABV.IBU <- BreweriesFullDataset %>% group_by(State)%>% summarise(Median_ABV=median(ABV,na.rm=TRUE),Median_IBU=median(IBU,na.rm=TRUE))

ggplot(Median.ABV.IBU,aes(x=reorder(State,-Median_ABV),y=Median_ABV,fill=Median_ABV)) +
  geom_bar(stat="identity",position="dodge",show.legend=FALSE) + xlab("State") + ylab("ABV") +
  ggtitle("Median ABV by State") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust=0.5))

ggplot(Median.ABV.IBU,aes(x=reorder(State,-Median_IBU),y=Median_IBU,fill=Median_IBU)) +
  geom_bar(stat="identity",position="dodge",show.legend=FALSE) +
  xlab("State") + ylab("Median IBU by State") +
  ggtitle("IBU by State") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust=0.5))
```

## Max ABV & IBU
```{r question5}
BreweriesFullDataset[which.max(BreweriesFullDataset$ABV),]
BreweriesFullDataset[which.max(BreweriesFullDataset$IBU),]
```

## Correlation between ABV & IBU
```{r question7}
ggplot(BreweriesFullDataset, aes(x=IBU, y=ABV)) +
  geom_point(color="#93e45c") +
  stat_smooth(method="lm",se=F) +
  theme(plot.title = element_text(hjust = 0.5)) +
  ggtitle("% Correlation between IBU and ABV")

#scatterplot(BreweriesFullDataset$IBU,BreweriesFullDataset$ABV,xlab="IBU",ylab="ABV",main="Relationship between ABV and IBU",smooth = FALSE, grid = FALSE, frame = FALSE, col="#93e45c")

cor.test(BreweriesFullDataset$IBU,BreweriesFullDataset$ABV,method=c("pearson","kendall","spearman"),use="complete.obs")
lm <- lm(IBU~ABV,data=BreweriesFullDataset)
summary(lm)$r.squared
```

## Conclusion

With the data provided, we concluded there is a market for craft beer due to different styles becoming more desirable.  Opportunity for growth in establishing a brewery could be sought in states where there is already a footprint established or trending in that direction based off of the number of breweries by state. 
